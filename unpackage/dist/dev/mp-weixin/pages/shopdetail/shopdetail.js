(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopdetail/shopdetail"],{287:
/*!***************************************************************************************!*\
  !*** D:/myself/work/student_video/main.js?{"page":"pages%2Fshopdetail%2Fshopdetail"} ***!
  \***************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";(function(e){i(/*! uni-pages */4);o(i(/*! vue */2));var t=o(i(/*! ./pages/shopdetail/shopdetail.vue */288));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},288:
/*!********************************************************************!*\
  !*** D:/myself/work/student_video/pages/shopdetail/shopdetail.vue ***!
  \********************************************************************/
/*! no static exports found */function(e,t,i){"use strict";i.r(t);var o=i(/*! ./shopdetail.vue?vue&type=template&id=cc452634& */289),n=i(/*! ./shopdetail.vue?vue&type=script&lang=js& */291);for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);i(/*! ./shopdetail.vue?vue&type=style&index=0&lang=scss& */298);var a,c=i(/*! ../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */14),s=Object(c["default"])(n["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);s.options.__file="pages/shopdetail/shopdetail.vue",t["default"]=s.exports},289:
/*!***************************************************************************************************!*\
  !*** D:/myself/work/student_video/pages/shopdetail/shopdetail.vue?vue&type=template&id=cc452634& ***!
  \***************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,i){"use strict";i.r(t);var o=i(/*! -!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopdetail.vue?vue&type=template&id=cc452634& */290);i.d(t,"render",(function(){return o["render"]})),i.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),i.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),i.d(t,"components",(function(){return o["components"]}))},290:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/myself/work/student_video/pages/shopdetail/shopdetail.vue?vue&type=template&id=cc452634& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,i){"use strict";var o;i.r(t),i.d(t,"render",(function(){return n})),i.d(t,"staticRenderFns",(function(){return a})),i.d(t,"recyclableRender",(function(){return r})),i.d(t,"components",(function(){return o}));var n=function(){var e=this,t=e.$createElement;e._self._c},r=!1,a=[];n._withStripped=!0},291:
/*!*********************************************************************************************!*\
  !*** D:/myself/work/student_video/pages/shopdetail/shopdetail.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";i.r(t);var o=i(/*! -!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopdetail.vue?vue&type=script&lang=js& */292),n=i.n(o);for(var r in o)"default"!==r&&function(e){i.d(t,e,(function(){return o[e]}))}(r);t["default"]=n.a},292:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/myself/work/student_video/pages/shopdetail/shopdetail.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(/*! ../../lib/wxParse/wxParse.js */293),n={components:{},data:function(){return{id:23851,goods:{},groupon:[],grouponLink:{},attribute:[],issueList:[],comment:[],brand:{},specificationList:[],productList:[],relatedGoods:[],cartGoodsCount:0,userHasCollect:0,number:1,checkedSpecText:"规格数量选择",tmpSpecText:"请选择规格数量",checkedSpecPrice:0,openAttr:!1,openShare:!1,noCollectImage:"/static/images/icon_like.png",hasCollectImage:"/static/images/icon_like_checked.png",collectImage:"/static/images/icon_like.png",shareImage:"",isGroupon:!1,soldout:!1,canWrite:!1}},onLoad:function(e){console.log("shopdetail",e),this.getGoodsInfo(),e.id&&(this.id=parseInt(e.id),this.getGoodsInfo()),e.grouponId&&(this.isGroupon=!0,this.getGrouponInfo(e.grouponId));var t=this;wx.getSetting({success:function(e){console.log(e),e.authSetting["scope.writePhotosAlbum"]?t.canWrite=!0:wx.authorize({scope:"scope.writePhotosAlbum",success:function(){t.canWrite=!0},fail:function(e){t.canWrite=!1}})}})},onShow:function(){var e=this;this.api._get("cart/goodscount",{id:e.id},(function(t){e.cartGoodsCount=t.data}))},onShareAppMessage:function(){var e=this,t=wx.getStorageSync("userInfo"),i=1;return t&&(i=t.userId),{title:e.goods.name,desc:"好货分享",path:"/pages/index/index?goodId="+this.id+"&shareUserId="+i}},methods:{shareFriendOrCircle:function(){if(!1!==this.openShare)return!1;this.openShare=!this.openShare},addFast:function(){var t=this;if(0==this.openAttr)this.openAttr=!this.openAttr;else{if(!this.isCheckedAllSpec())return wx.showToast({image:"/static/images/icon_error.png",title:"请选择完整规格"}),!1;var i=this.getCheckedProductItem(this.getCheckedSpecKey());if(!i||i.length<=0)return wx.showToast({image:"/static/images/icon_error.png",title:"没有库存"}),!1;var o=i[0];if(o.number<=0)return wx.showToast({image:"/static/images/icon_error.png",title:"没有库存"}),!1;var n=this.getCheckedGrouponValue();this.api._post("cart/fastadd",{goodsId:this.goods.id,number:this.number,productId:o.id},(function(i){if(0==i.errno)try{wx.setStorageSync("cartId",i.data),wx.setStorageSync("grouponRulesId",n.id),wx.setStorageSync("grouponLinkId",t.grouponLink.id),e.navigateTo({url:"/pages/order/creatOrder"})}catch(o){}else wx.showToast({image:"/static/images/icon_error.png",title:i.errmsg,mask:!0})}))}},addCollectOrNot:function(){var e=this;this.api._post("collect/addordelete",{type:0,valueId:this.id},(function(t){var i=t;0==i.errno?"add"==i.data.type?e.collectImage=e.hasCollectImage:e.collectImage=e.noCollectImage:wx.showToast({image:"/static/images/icon_error.png",title:i.errmsg,mask:!0})}))},getCheckedGrouponValue:function(){for(var e={},t=this.groupon,i=0;i<t.length;i++)t[i].checked&&(e=t[i]);return e},getGoodsInfo:function(){var e=this;this.api._get("goods/detail",{id:e.id},(function(t){if(0===t.errno){var i=t.data.specificationList;if(1==i.length&&1==i[0].valueList.length){i[0].valueList[0].checked=!0;var n=t.data.productList[0].price,r=t.data.info.retailPrice;n!=r&&console.error("商品数量价格和货品不一致"),e.checkedSpecText=i[0].valueList[0].value,e.tmpSpecText="已选择："+i[0].valueList[0].value}if(e.goods=t.data.info,e.attribute=t.data.attribute,e.issueList=t.data.issue,e.comment=t.data.comment,e.brand=t.data.brand,e.specificationList=t.data.specificationList,e.productList=t.data.productList,e.userHasCollect=t.data.userHasCollect,e.shareImage=t.data.shareImage,e.checkedSpecPrice=t.data.info.retailPrice,e.groupon=t.data.groupon,e.isGroupon){for(var a=e.groupon,c=0;c<a.length;c++)a[c].id!=e.grouponLink.rulesId&&a.splice(c,1);a[0].checked=!0,e.groupon=a}1==t.data.userHasCollect?e.collectImage=e.hasCollectImage:e.collectImage=e.noCollectImage,o.wxParse("goodsDetail","html",t.data.info.detail,e)}}))},getGrouponInfo:function(e){var t=this;util.request(api.GroupOnJoin,{grouponId:e}).then((function(e){0===e.errno&&(t.setData({grouponLink:e.data.groupon,id:e.data.goods.id}),t.getGoodsInfo())}))},switchAttrPop:function(){0==this.openAttr&&(this.openAttr=!this.openAttr)},closeAttr:function(){this.openAttr=!1},clickSkuValue:function(e){for(var t=this,i=e.currentTarget.dataset.name,o=e.currentTarget.dataset.valueId,n=this.specificationList,r=0;r<n.length;r++)if(n[r].name===i)for(var a=0;a<n[r].valueList.length;a++)n[r].valueList[a].id==o?n[r].valueList[a].checked?n[r].valueList[a].checked=!1:(n[r].valueList[a].checked=!0,t.setSpecificationUrl(n[r].valueList[a].picUrl)):n[r].valueList[a].checked=!1;this.specificationList=n,this.changeSpecInfo()},getCheckedSpecValue:function(){for(var e=[],t=this.specificationList,i=0;i<t.length;i++){for(var o={name:t[i].name,valueId:0,valueText:""},n=0;n<t[i].valueList.length;n++)t[i].valueList[n].checked&&(o.valueId=t[i].valueList[n].id,o.valueText=t[i].valueList[n].value);e.push(o)}return e},setSpecificationUrl:function(e){e&&e.length>1&&-1==e.indexOf("lazyload.png")&&(this.checkSpecificationUrl=e)},changeSpecInfo:function(){var e=this.getCheckedSpecValue(),t=e.filter((function(e){return 0!=e.valueId})).map((function(e){return e.valueText}));if(t.length>0?this.tmpSpecText=t.join("　"):this.tmpSpecText="请选择规格数量",this.isCheckedAllSpec()){this.checkedSpecText=this.tmpSpecText;var i=this.getCheckedProductItem(this.getCheckedSpecKey());if(!i||i.length<=0)return this.soldout=!0,void console.error("规格所对应货品不存在");var o=i[0];o.number>0?(this.checkedSpecPrice=o.price,this.soldout=!1):(this.checkedSpecPrice=this.goods.retailPrice,this.soldout=!0)}else this.checkedSpecText="规格数量选择",this.checkedSpecPrice=this.goods.retailPrice,this.soldout=!1},isCheckedAllSpec:function(){return!this.getCheckedSpecValue().some((function(e){if(0==e.valueId)return!0}))},getCheckedSpecKey:function(){var e=this.getCheckedSpecValue().map((function(e){return e.valueText}));return e},getCheckedProductItem:function(e){return this.productList.filter((function(t){return console.log(e.toString()+"--"+t.specifications.toString()),t.specifications.toString()==e.toString()}))},addNumber:function(){this.number=this.number+1},addToCart:function(){var e=this;if(0==this.openAttr)this.openAttr=!this.openAttr;else{if(!this.isCheckedAllSpec())return wx.showToast({image:"/static/images/icon_error.png",title:"请选择完整规格"}),!1;var t=this.getCheckedProductItem(this.getCheckedSpecKey());if(!t||t.length<=0)return wx.showToast({image:"/static/images/icon_error.png",title:"没有库存"}),!1;var i=t[0];if(i.number<=0)return wx.showToast({image:"/static/images/icon_error.png",title:"没有库存"}),!1;this.api._post("cart/add",{goodsId:this.goods.id,number:this.number,productId:i.id},(function(t){var i=t;0==i.errno?(wx.showToast({title:"添加成功"}),e.openAttr=!e.openAttr,e.cartGoodsCount=i.data,1==e.userHasCollect?e.collectImage=e.hasCollectImage:e.collectImage=e.noCollectImage):wx.showToast({image:"/static/images/icon_error.png",title:i.errmsg,mask:!0})}))}},cutNumber:function(){this.number=this.number-1>1?this.number-1:1},openCartPage:function(){e.navigateTo({url:"/pages/shopcar/shopcar"})},closeShare:function(){this.openShare=!1}}};t.default=n}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},298:
/*!******************************************************************************************************!*\
  !*** D:/myself/work/student_video/pages/shopdetail/shopdetail.vue?vue&type=style&index=0&lang=scss& ***!
  \******************************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";i.r(t);var o=i(/*! -!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--8-oneOf-1-3!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../uniapp/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopdetail.vue?vue&type=style&index=0&lang=scss& */299),n=i.n(o);for(var r in o)"default"!==r&&function(e){i.d(t,e,(function(){return o[e]}))}(r);t["default"]=n.a},299:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/myself/work/student_video/pages/shopdetail/shopdetail.vue?vue&type=style&index=0&lang=scss& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,i){}},[[287,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/shopdetail/shopdetail.js.map