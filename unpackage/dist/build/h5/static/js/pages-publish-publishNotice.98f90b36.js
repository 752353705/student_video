(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-publish-publishNotice"],{"067e":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAACC0lEQVRIS72Wz0/UUBDHv4P0ofwHkvStt23DEa4QOepJDpiIhmCCeOPHybAcxAPgDeUGmmCMYqIHPMlRglevpl1P7muC/4HIK+yYvljCut22sGt76+vMfKYz3zfvEc7x/Cj1Xj3ksC9yuULWwbXar5953SnLsCqtCRDdYsZoki0RdsD8sazC12mxWoK+2d1Dl9C1AMKNrGTMd8buCeqr/cHxl8SEkhZ9KcYAvM8FaDa67Sj94d/lpj/ypFgi4PEFIX9/Dk9cpZfOxmgAeVIsELDSDiT2ZaDiKr0av5+CTE+oa78TkDjGCdeH456dgnxbfEpsPPMeiK6nJtDKhrHrBPpm5GtAni3uEGG7KRjznhOEI54tKkRYToIxY9EN9IpvW5+TEmLGuBvodwZUlWKLgclEWTIWy1Eg2TMD8PNGG5p11NF61RYVbpEIAa/KSt83IF8KTu8NzTvq6Fm1ZE0x0wtTCuIH5Vr40pc9cwCvpfk7ShNFY+U3Hx9kiYDBD10VbnolMR7ZujW97UlrmkAbWb6XqbuPPGkNEOhrlrH5Trjn1PRbU4WSuAvGmzx+DB68MOi7bU3WibZyg9opnS/FIwBPs2CmdO2KIc/IMmLohLzTYA3y7sSGbQVr2LCmfEWMoAhU2FA1M6+IYyKWaB4VZcmZkXHwxQEKOcpjWCGXk7Ol+e/XraQ+tHOB/AOB8ibIA93buAAAAABJRU5ErkJggg=="},"25f5":function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"pused"},[n("v-uni-view",{staticClass:"uni-popup-message-text"},[n("v-uni-view",{staticClass:"img_box"},[n("v-uni-view",{staticClass:"cont_box"},[t._l(t.images,(function(e,a){return n("v-uni-view",{key:a,staticClass:"content",staticStyle:{"background-color":"black"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.detailImg.apply(void 0,arguments)}}},[n("v-uni-image",{attrs:{src:e.url,mode:"aspectFit"}}),n("v-uni-image",{staticClass:"img",attrs:{src:i("067e"),mode:""},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.clear(t.num,a)}}})],1)})),t.images.length!=t.nowCount?n("v-uni-view",{staticClass:"content",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.chooseImages.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"cross"})],1):t._e()],2)],1),t.btn_statue?n("v-uni-view",{staticClass:"btn",staticStyle:{"background-color":"#BBBBBB"}},[t._v("发布中...")]):n("v-uni-view",{staticClass:"btn",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.pushImg.apply(void 0,arguments)}}},[t._v("发布")])],1),n("v-uni-input",{staticClass:"input",attrs:{type:"text",name:"title",value:t.title,placeholder:"添加标题会有更多赞哦"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.titInput.apply(void 0,arguments)}}}),n("v-uni-textarea",{staticClass:"txt_area",attrs:{"show-confirm-bar":!1,name:"area",value:t.areaVal,placeholder:"说说此刻心情",maxlength:-1},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.areaInput.apply(void 0,arguments)}}}),n("v-uni-picker",{attrs:{value:t.value,range:t.game_type,"range-key":"subjectTitle"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindPickerChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"topic",class:t.topic?"act":""},[n("v-uni-view",{staticClass:"le"},[n("v-uni-view",{staticClass:"tag"},[t._v("#")]),t._v(t._s(t.topic||"参与话题"))],1),n("v-uni-view",{staticClass:"iconfont iconfanhui"})],1)],1)],1)},o=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}))},"2c6c":function(t,e,i){"use strict";var n=i("79c4"),a=i.n(n);a.a},"57ac":function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */\r\n/* 页面左右间距 */\r\n/* 文字尺寸 */\r\n/*文字颜色*/\r\n/* 边框颜色 */\r\n/* 图片加载中颜色 */\r\n/* 行为相关颜色 */.pused[data-v-6d69b2a9]{overflow:auto;box-sizing:border-box;padding:20px;padding-bottom:100px}.pused .input[data-v-6d69b2a9]{width:100%;height:%?73?%;line-height:%?73?%;border-radius:%?30?%;overflow:hidden;box-sizing:border-box;padding-left:%?20?%;margin-top:%?20?%}.pused .topic[data-v-6d69b2a9]{margin-top:%?20?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.pused .topic .le .tag[data-v-6d69b2a9]{display:inline-block;width:%?32?%;text-align:center;border-radius:50%;line-height:%?32?%;background-color:#000;color:#fff;margin-right:%?10?%}.pused .topic.act .le[data-v-6d69b2a9]{color:#5994e2}.pused .topic.act .le .tag[data-v-6d69b2a9]{background-color:#5994e2}.pused .txt_area[data-v-6d69b2a9]{width:100%;height:%?278.47?%;border-radius:%?20?%;margin-top:%?5?%;box-sizing:border-box;padding:%?30?%;padding-left:%?20?%;border-top:%?1?% solid #f2f2f2;border-bottom:%?1?% solid #f2f2f2}.pused .uni-popup-message-text[data-v-6d69b2a9]{width:100%;font-size:14px;position:relative;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start;overflow:hidden}.pused .uni-popup-message-text .tit[data-v-6d69b2a9]{margin-top:10px}.pused .uni-popup-message-text .coverImg[data-v-6d69b2a9]{margin-top:%?23?%;width:%?203.58?%;height:%?189.58?%;background-color:#f2f2f2;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;border-radius:%?23?%}.pused .uni-popup-message-text .cover_content[data-v-6d69b2a9]{margin-top:%?20?%;position:relative;width:%?203.58?%;height:%?189.58?%}.pused .uni-popup-message-text .cover_content uni-image[data-v-6d69b2a9]{width:100%;height:100%}.pused .uni-popup-message-text .cover_content .img[data-v-6d69b2a9]{position:absolute;width:%?40?%;height:%?40?%;top:%?3?%;right:%?-16?%}.pused .uni-popup-message-text .img_box[data-v-6d69b2a9]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;position:relative}.pused .uni-popup-message-text .img_box .shownum[data-v-6d69b2a9]{position:absolute;top:%?16?%;right:%?27?%;z-index:50;width:%?65?%;height:%?40?%;text-align:center;line-height:%?40?%;background-color:#f2f2f2;border-radius:%?16?%}.pused .uni-popup-message-text .img_box .cont_box[data-v-6d69b2a9]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:start;justify-content:start;-webkit-flex-wrap:wrap;flex-wrap:wrap;width:100%}.pused .uni-popup-message-text .img_box .cont_box .content[data-v-6d69b2a9]{color:#fff;font-size:%?30?%;position:relative;width:%?203.58?%;height:%?189.58?%;border:%?1?% solid #f2f2f2;text-align:center;margin-right:%?20?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;border-radius:%?23?%}.pused .uni-popup-message-text .img_box .cont_box .content uni-image[data-v-6d69b2a9]{width:100%;height:100%}.pused .uni-popup-message-text .img_box .cont_box .content .img[data-v-6d69b2a9]{position:absolute;width:%?40?%;height:%?40?%;top:%?3?%;right:%?-16?%}.pused .uni-popup-message-text .img_box .contimg[data-v-6d69b2a9]{display:inline-block}.pused .uni-popup-message-text .btn[data-v-6d69b2a9]{width:%?260.22?%;height:%?83.66?%;text-align:center;line-height:%?83.66?%;background-color:#f93;border-radius:%?40?%;color:#fff;font-size:%?36?%;font-weight:bolder;position:fixed;bottom:36px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.pused .uni-popup-message-text .c_circle[data-v-6d69b2a9]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.cross[data-v-6d69b2a9]{background:#888;height:%?61?%;position:relative;width:%?6?%}.cross[data-v-6d69b2a9]:after{background-color:#888;content:"";height:%?6?%;left:%?-27?%;position:absolute;top:%?28?%;width:%?61?%}',""]),t.exports=e},"5ca8":function(t,e,i){"use strict";i.r(e);var n=i("25f5"),a=i("a916");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("2c6c");var s,r=i("f0c5"),l=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"6d69b2a9",null,!1,n["a"],s);e["default"]=l.exports},"79c4":function(t,e,i){var n=i("57ac");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("297b6d57",n,!0,{sourceMap:!1,shadowMode:!1})},"7daa":function(t,e,i){"use strict";i("99af"),i("4160"),i("a15b"),i("a434"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{publish_type:"",topic:"",value:"",game_type:"",subjectId:"",TImg:"",images:[],imgArr:[],num:0,count:0,nowCount:1,btn_statue:!1,title:"",areaVal:"",videoFile:null,progress:0,cameraList:[{value:"back",name:"后置摄像头",checked:"true"},{value:"front",name:"前置摄像头"}]}},onLoad:function(t){var e=this;console.log("上传文章的界面  option",t),this.api._get("subject/onGoing",{subjectTypeId:"",pageNum:1,pageSize:10},(function(t){console.log("请求大赛类型",t),e.game_type=t.data.list}))},onShow:function(){console.log("页面显示"),this.btn_statue=!1,this.topic=JSON.parse(uni.getStorageSync("gameMsg")).subjectTitle,this.subjectId=JSON.parse(uni.getStorageSync("gameMsg")).subjectId},methods:{getSignature:function(t){var e=this;e.api._get("cloud/vod/getUploadSignature",{},(function(e){if(0!=e.errno)return"获取签名失败";t(e.data)}))},bindPickerChange:function(t){console.log("picker发送选择改变，携带值为",t),this.value=t.detail.value,this.topic=this.game_type[t.detail.value].subjectTitle,this.subjectId=this.game_type[t.detail.value].subjectId},titInput:function(t){this.title=t.detail.value},areaInput:function(t){this.areaVal=t.detail.value},publish:function(){0==this.publish_type?this.pushImg():1==this.publish_type&&this.startUpload()},pushImg:function(){if(0!=this.images.length&&0!=this.title.length&&0!=this.areaVal.length&&this.topic){this.btn_statue=!0,this.num=0;var t=this;uni.showLoading({title:"正在发布.."}),this.images.forEach((function(e){uni.uploadFile({url:t.api.api_root+"picture/upload",filePath:e.url,name:"file",header:{"Content-Type":"multipart/form-data"},success:function(e){if(200==e.statusCode){var i=JSON.parse(e.data);if(500==i.errno)return uni.hideLoading(),t.btn_statue=!1,uni.showModal({title:"图片信息不合法，请重新选择"});console.log("向imgArr 添加图片"),t.imgArr.push(JSON.parse(e.data).data),t.num++,t.num!=t.images.length&&t.imgArr.length!=t.images.length||t.pushAll()}else uni.hideLoading(),uni.showToast({title:"出错请重新上传",icon:"none"}),t.btn_statue=!1}})}))}else uni.showToast({title:"请填写完整之后上传",icon:"none"})},pushAll:function(){var t=this;this.api._post("article",{coverUrl:t.TImg||t.imgArr[0],content:t.areaVal,title:t.title,images:t.imgArr.join(","),subjectId:t.subjectId},(function(e){console.log(e),uni.hideLoading(),uni.showToast({title:"发布"+e.errmsg,icon:"none",success:function(){uni.switchTab({url:"/pages/my/my"})}}),t.areaVal="",t.count=0,t.title="",t.topic="",t.images=[],t.imgArr=[],t.btn_statue=!1}),(function(e){console.log(e),uni.hideLoading(),t.btn_statue=!1,uni.showToast({title:"发布失败",icon:"none"})}))},detailImg:function(t){console.log("预览图片");var e=[];1==t?e.push(this.TImg):this.images.forEach((function(t){e.push(t.url)})),uni.previewImage({urls:e,indicator:"number",loop:!0})},clear:function(t,e){1==t?this.TImg="":(console.log("删除当前作品"),this.$emit("clear"),this.images.splice(e,1),this.imgArr.splice(e,1),this.num=this.num-1,this.count=this.images.length)},chooseVideoImage:function(){var t=this;uni.showActionSheet({title:"选择上传类型",itemList:["图片","视频"],success:function(e){console.log(e),t.publish_type=e.tapIndex,0==e.tapIndex?t.chooseImages():t.chooseVideo()}})},chooseImages:function(){var t=this;uni.chooseImage({count:t.nowCount-t.count,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var i=e.tempFilePaths.length;t.count+=i,console.log("选择的图片",e),e.tempFiles.forEach((function(t,e){t.size>1048576&&uni.showToast({title:"第"+e+"张图片大小超过1m,请重新选择",icon:"none"})})),e.tempFilePaths.forEach((function(e){t.images=t.images.concat({url:e})}))}})},chooseVideo:function(){var t=this;uni.chooseVideo({maxDuration:60,count:1,camera:t.cameraList[0].value,sourceType:["album"],success:function(e){t.videoFile=e,t.images=t.images.concat({url:t.videoFile.thumbTempFilePath})}})},startUpload:function(){var t=this;t.btn_statue=!0;VodUploader.start({mediaFile:t.videoFile,getSignature:t.getSignature,mediaName:t.title,coverFile:"",error:function(e){console.log("error"),console.log(e),wx.showModal({title:"请重新选择视频",content:"视频长度为俩分钟",showCancel:!1}),t.btn_statue=!1},progress:function(t){console.log("progress"),console.log(t)},finish:function(t){console.log("finish"),console.log(t),wx.showModal({title:"上传成功",content:"fileId:"+t.fileId+"\nvideoName:"+t.videoName,showCancel:!1})}})}}};e.default=n},a916:function(t,e,i){"use strict";i.r(e);var n=i("7daa"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a}}]);