(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/my"],{"0c8a":function(e,n,o){"use strict";o.r(n);var t=o("5378"),i=o.n(t);for(var s in t)"default"!==s&&function(e){o.d(n,e,(function(){return t[e]}))}(s);n["default"]=i.a},"3d8d":function(e,n,o){},5378:function(e,n,o){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=i(o("6bae"));function i(e){return e&&e.__esModule?e:{default:e}}var s=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup-sigin")]).then(function(){return resolve(o("b304"))}.bind(null,o)).catch(o.oe)},a=function(){Promise.all([o.e("common/vendor"),o.e("components/mescroll-swiper-item")]).then(function(){return resolve(o("8704"))}.bind(null,o)).catch(o.oe)},u=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup-usermsg")]).then(function(){return resolve(o("4b42"))}.bind(null,o)).catch(o.oe)},c=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup-useoperation")]).then(function(){return resolve(o("2c50"))}.bind(null,o)).catch(o.oe)},r=function(){o.e("components/swiper-tab-head").then(function(){return resolve(o("5601"))}.bind(null,o)).catch(o.oe)},l=(getApp(),{mixins:[t.default],data:function(){return{showsigin:!1,userInfo:{likes:0},off:[0,-6],showbadge:!0,opertop:"300rpx",operleft:"100rpx",txtid:"",swiper_height:"",tabIndex:0,tabBars:[{name:"图文",id:"myTxt"}],kw:"myTxt",act:0,useList:[{icon:"icongerenziliao",txt:"个人资料"},{icon:"iconyue",txt:"我的H币"},{icon:"iconchongzhi",txt:"充值"},{icon:"icontuichudenglu",txt:"退出登录"},{icon:"iconshoucang2",txt:"我的收藏"},{icon:"icont-icon-test-copy",txt:"浏览记录"}],tic_num:0,user_img:"",user_name:"",user_phone:"",fansNum:0,focusNum:0}},components:{uniPopupSigin:s,swiperTabHead:r,MescrollItem:a,uniPopupUsermsg:u,uniPopupUseoperation:c},onLoad:function(){this.swiper_height=e.getSystemInfoSync().windowHeight+"px";console.log("我的页面"),e.showLoading({title:"加载中"})},onReady:function(){console.log("页面加载完毕"),e.hideLoading()},onShow:function(){this.user_name=e.getStorageSync("user_name"),this.user_img=e.getStorageSync("user_img")||"/static/avatarUrl.png",this.user_phone=e.getStorageSync("user_phone"),this.getUsInfo(),this.getFocusNum(),this.getFansNum(),e.getStorageSync("token")?this.showsigin=!0:this.showsigin=!1},onHide:function(){this.$refs.popup_useoperation.close()},methods:{getUsInfo:function(){var n=this;e.getStorageSync("token")&&this.api._get("user/info",{},(function(e){console.log("获取用户当前的 H币",e),n.userInfo=e.data}))},getFansNum:function(){var n=this;e.getStorageSync("token")&&this.api._get("follow/fansCount",{},(function(e){console.log("获取用户当前的 粉丝数量",e),n.fansNum=e.data||"0"}))},getFocusNum:function(){var n=this;e.getStorageSync("token")&&this.api._get("follow/followedCount",{},(function(e){console.log("获取用户当前的 关注人数",e),n.focusNum=e.data||0}))},sigin:function(){var n=this;if(console.log("进行签到"),e.getStorageSync("sigin"))console.log("有签到信息"),this.sigin_api();else{if(!e.getStorageSync("token"))return e.showToast({icon:"none",title:"请先完成登录"});this.api._post("user/signResult",{},(function(o){if(console.log("没有 sigin",o),"no"!=o.data)return e.showToast({icon:"none",title:"已进行签到"});n.api._post("user/sign",{},(function(){console.log("签到成功"),n.getUsInfo();var o=(new Date).setHours(0,0,0,0)+864e5-(new Date).getTime()+3e5,t={state:1,siginTime:(new Date).getTime(),overTime:o};e.setStorage({key:"sigin",data:JSON.stringify(t),success:function(){console.log("设置过期时间成功")}}),n.$refs.popup_sigin.open()}))}))}},sigin_api:function(){var n=this,o=(new Date).getTime();o-JSON.parse(e.getStorageSync("sigin")).siginTime>JSON.parse(e.getStorageSync("sigin")).overTime?(console.log("应当重新进行签到了"),this.api._post("user/signResult",{},(function(o){if(console.log("没有 sigin",o),"no"==o.data){var t=(new Date).setHours(0,0,0,0)+864e5-(new Date).getTime()+3e5,i={state:1,siginTime:(new Date).getTime(),overTime:t};n.api._post("user/sign",{},(function(){console.log("签到成功"),n.getUsInfo(),n.$refs.popup_sigin.open(),e.setStorage({key:"sigin",data:JSON.stringify(i),success:function(){console.log("设置过期时间成功")}})}))}else e.showToast({icon:"none",title:"已成功签到"})}))):e.showToast({icon:"none",title:"已成功签到"})},showSigin:function(){this.$refs.popup_sigin.close()},goChart:function(){var n=this;e.navigateTo({url:"/pages/chart/chartList",success:function(){n.showbadge=!1}})},closeUsermsg:function(){this.$refs.popup_user.close()},showUseroperation:function(e,n){console.log("list 中 按钮显示的位置","location ==>",JSON.parse(n)),console.log("用户进行点击的目标信息",e),this.opertop=JSON.parse(n).btntop,this.operleft=JSON.parse(n).btnleft,this.txtid=e,this.$refs.popup_useoperation.open()},closeUseroperation:function(){this.$refs.popup_useoperation.close()},decryptPhoneNumber:function(e){var n=this;this.api._post("auth/bindPhone",{encryptedData:e.detail.encryptedData,iv:e.detail.iv},(function(e){console.log("绑定手机号 res",e),wx.setStorageSync("user_phone",e.data.phone),n.user_phone=e.data.phone}))},goFans:function(n){console.log("跳转到粉丝列表"),1==n?e.navigateTo({url:"/pages/my/myFocus"}):2==n&&e.navigateTo({url:"/pages/my/myFans"})},tabChange:function(e){this.tabIndex=e.detail.current,console.log("滑动的 id",this.tabBars[this.tabIndex].id),this.kw=this.tabBars[this.tabIndex].id},tabtap:function(e){this.tabIndex=e,console.log("点击的 id",this.tabBars[this.tabIndex].id),this.kw=this.tabBars[this.tabIndex].id},getLoadNum:function(n){console.log("共加载了:"+n),!this.isNewRenderDone&&e.hideLoading(),this.isNewRenderDone=!0},goPlayVideo:function(){e.navigateTo({url:"/pages/playVideo/playVideo"})},open:function(n){var o=this;0===n?this.$refs.popup_user.open():1===n?e.navigateTo({url:"/pages/my/myConsumption"}):2===n?(console.log("用户进行充值操作"),e.navigateTo({url:"/pages/recharge/recharge?money=".concat(this.userInfo.hgold,"&userId=").concat(this.userInfo.userId)})):3===n?e.showModal({title:"提示",content:"确定退出吗",success:function(n){n.confirm?(console.log("用户点击确定"),o.api._post("auth/logout",{},(function(n){console.log("用户进行退出操作",n),e.clearStorageSync(),o.user_name="",o.user_img="/static/avatarUrl.png",o.user_phone=""}))):n.cancel&&console.log("用户点击取消")},fail:function(){console.log("调用接口失败")}}):4===n?e.navigateTo({url:"/pages/my/myCollection"}):5===n?e.navigateTo({url:"/pages/my/myHistory"}):6===n&&e.navigateTo({url:"/pages/my/myRun"})},close:function(e){this.$refs.popup_user.close()},jump:function(){console.log("跳转页面"),e.navigateTo({url:"/pages/login/login"})}}});n.default=l}).call(this,o("543d")["default"])},"92bf":function(e,n,o){"use strict";var t=o("3d8d"),i=o.n(t);i.a},aae8:function(e,n,o){"use strict";o.r(n);var t=o("dc54"),i=o("0c8a");for(var s in i)"default"!==s&&function(e){o.d(n,e,(function(){return i[e]}))}(s);o("92bf");var a,u=o("f0c5"),c=Object(u["a"])(i["default"],t["b"],t["c"],!1,null,"027f1198",null,!1,t["a"],a);n["default"]=c.exports},dc54:function(e,n,o){"use strict";var t={uniPopup:function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(o.bind(null,"f48e"))}},i=function(){var e=this,n=e.$createElement;e._self._c},s=[];o.d(n,"b",(function(){return i})),o.d(n,"c",(function(){return s})),o.d(n,"a",(function(){return t}))},f23a:function(e,n,o){"use strict";(function(e){o("21be");t(o("66fd"));var n=t(o("aae8"));function t(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,o("543d")["createPage"])}},[["f23a","common/runtime","common/vendor"]]]);