(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/playVideo/txtDetail"],{"02b4":function(t,e,n){"use strict";var o=n("8cb9"),i=n.n(o);i.a},"62dc":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){n.e("components/sin-barrage/sin-barrage").then(function(){return resolve(n("b4b6"))}.bind(null,n)).catch(n.oe)},i=function(){n.e("components/uni-popup/uni-popup-message").then(function(){return resolve(n("9447"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/uni-popup/uni-popup-share").then(function(){return resolve(n("daf5"))}.bind(null,n)).catch(n.oe)},a=function(){n.e("components/uni-popup/uni-popup-comments").then(function(){return resolve(n("0ca6"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/uni-popup/uni-pupup-detail-comments").then(function(){return resolve(n("dc0d"))}.bind(null,n)).catch(n.oe)},u=function(){n.e("components/uni-popup/uni-popup-gifts").then(function(){return resolve(n("0b1d"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("components/uni-popup/uni-popup-rank").then(function(){return resolve(n("159a"))}.bind(null,n)).catch(n.oe)},r={data:function(){return{collection_msg:"",scroll_style:!1,is_IOS:!1,offset:[-12,-12],sinBar:!0,list:[],bottom:500,left:42,color:"#FFFFFF",background:"#000000",msec:2e3,rankList:[{num:667,txt:"票数"},{num:1,txt:"排名"},{num:0,txt:"距离上一名"}],rank:[],money:0,fanlist:[],clt:!1,txtItem:{title:"",content:""},imgArr:"",txtId:"",userName:"",avatarUrl:"",forwardCount:0,timeStamp:0,pageNum:1,msgList:[],detailMsgList:{},commentState:!0,detail_index:""}},components:{uniPopupMessage:i,sinBarrage:o,uniPopupShare:s,uniPopupComments:a,uniPopupGifts:u,uniPopupDetailComments:c,uniPopupRank:l},onLoad:function(e){this.txtId=e.txtId,this.getGift(e.txtId),this.getTxtDetail(this.txtId),this.userName=t.getStorageSync("user_name"),this.avatarUrl="/static/avatarUrl.png",t.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),this.getPhoneType()},onShow:function(){this.api._post("history",{itemId:this.txtId,itemType:"A"},(function(t){})),this.getRank()},onShareAppMessage:function(t){var e=this;return"button"===t.from&&console.log("按钮进行的转发",t),this.api._post("article/forward/".concat(e.txtId),{},(function(t){e.txtItem.forwardCount++})),{title:this.txtItem.title,path:"/pages/playVideo/txtDetail?txtId="+this.txtId}},onShareTimeline:function(){return"button"===res.from&&console.log("按钮进行的朋友圈转发",res),{title:this.txtItem.title,query:"txtId=".concat(this.txtId),imageUrl:this.imgArr[0]}},onPageScroll:function(){var t,e=this;if(this.scroll_style){if(this.timeout)return void clearTimeout(t);this.timeout=!0,t=setTimeout((function(){e.scroll_style=!1,e.timeout=!1}),3e3)}else this.scroll_style=!0},methods:{showDetailComment:function(t){var e=this;this.detail_index=t,e.detailMsgList=e.msgList[t],this.$refs.popupDetailComments.open()},getPhoneType:function(){switch(t.getSystemInfoSync().platform){case"android":console.log("运行Android上");break;case"ios":console.log("运行iOS上"),this.is_IOS=!0;break;default:console.log("运行在开发者工具上");break}},getRank:function(){var t=this;this.api._get("article/ranking/".concat(this.txtId),{},(function(e){console.log("获取当前作品排行",e),t.rank=e.data}))},getUserGift:function(t){var e=this;this.api._get("gift/article/user/gift/".concat(t),{},(function(t){console.log(" 获取刷礼物 res",t),e.giftRank=t.data}))},goGameDetail:function(){t.navigateTo({url:"/pages/Introduction/gameDetail?subjectId=".concat(this.txtItem.subjectId)})},previewImg:function(){t.previewImage({current:0,urls:this.imgArr})},getGift:function(t){var e=this;this.api._get("gift/article/gift/".concat(t),{},(function(t){e.list=t.data}))},showSinBar:function(){this.sinBar=!1},goRank:function(){t.navigateTo({url:"/pages/rank/rank?articleId=".concat(this.txtItem.id)})},rankPopup:function(t,e){this.$refs.popupRank.open(),e()},hiddenRank:function(){this.$refs.popupRank.close()},getOtherFans:function(){var t=this;this.api._get("follow/otherUserfans",{userId:this.txtItem.userId,pageNum:this.pageNum,pageSize:10},(function(e){console.log("获取其他人的粉丝列表 res ===>",e),t.fanlist=e.data.list}))},gofansLis:function(){t.navigateTo({url:"/pages/my/myFans"})},collection:function(){var t=this;this.api._post("collection",{itemId:this.txtItem.id,itemType:"A"},(function(e){t.txtItem.collectionStatus=!t.txtItem.collectionStatus,console.log("进行收藏",e),t.txtItem.collectionStatus?(console.log("进行收藏"),t.collection_msg="收藏成功",t.$refs.popup.open()):(t.collection_msg="取消收藏",t.$refs.popup.open())}))},downImg:function(e){console.log("用户长按图片进行下载"),t.downloadFile({url:e,success:function(e){console.log("downloadFile成功",e),t.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(t){console.log("saveVideoToPhotosAlb、um成功",t),wx.hideLoading(),wx.showToast({title:"下载成功",icon:"none"})},fail:function(t){console.log("saveVideoToPhotosAlbum失败",t),"saveImageToPhotosAlbum:fail auth deny"==t.errMsg&&wx.showModal({title:"提示",content:"需要您授权保存相册",showCancel:!1,success:function(t){wx.openSetting({success:function(t){t.authSetting["scope.writePhotosAlbum"]?wx.showModal({title:"提示",content:"获取权限成功,再次点击下载即可保存",showCancel:!1}):wx.showModal({title:"提示",content:"获取权限失败，将无法保存到相册哦~",showCancel:!1})}})}})}})},fail:function(t){console.log("downloadFile失败",t)}})},getTxtDetail:function(t){var e=this;this.api._get("article/".concat(t),{},(function(t){console.log("获取文章的详情",t),e.txtItem=t.data,e.imgArr=t.data.images.split(","),e.getOtherFans()}))},getHgold:function(){var t=this;this.api._get("user/gold",{},(function(e){t.money=e.data.goldNumber,t.$refs.popupRecharge.open()}))},close:function(t){this.$refs.popupShare.close()},changeCommentsNum:function(t){this.txtItem.commentNum+=1},goAuthor:function(){var e={avatarUrl:this.txtItem.avatarUrl,userId:this.txtItem.userId};t.navigateTo({url:"/pages/author/author?item=".concat(JSON.stringify(e))})},focusOn:function(){var t=this;this.txtItem.followed?t.api._post("follow",{followedId:t.txtItem.userId},(function(e){t.txtItem.followed=!t.txtItem.followed,t.getOtherFans()})):this.api._post("follow",{followedId:t.txtItem.userId},(function(e){t.txtItem.followed=!t.txtItem.followed,t.getOtherFans()}))},sendGift:function(){this.$refs.popupGifts.open()},selectgift:function(e,n){var o=this;t.showModal({title:"提示",content:"您确定投".concat(e.item.goldNumber,"票吗"),success:function(n){n.confirm?o.api._post("gift/article",{articleId:o.txtItem.id,giftId:e.item.giftId},(function(n){507===n.data.errno?t.showModal({title:"当前票数不足"}):(wx.hideLoading(),setTimeout((function(){t.showToast({icon:"none",duration:2e3,title:"投票成功",success:function(){setTimeout((function(){o.getRank(),o.sinBar=!0,o.list=[{avatarImage:t.getStorageSync("user_img"),giftImage:e.item.giftImage,goldNumber:e.item.goldNumber}]}),2e3)}},500)})))})):n.cancel&&console.log("用户点击取消")}})},getComment:function(){var t=this;t.$refs.popupComments.open(),this.commentState&&this.api._get("article/comment/list",{pageNum:this.pageNum,pageSize:10,articleId:this.txtId},(function(e){if(console.log("请求文章评论 ===》 res",e.data.list),JSON.stringify(t.msgList)==JSON.stringify(e.data.list)&&0!==e.data.list.length)return!1;t.msgList=t.msgList.concat(e.data.list),10==e.data.list.length?(console.log("请求"),t.pageNum++,t.commentState=!0):(console.log("不请求"),t.commentState=!1)}))},changeComment:function(e){console.log("进行评论回复111111000",e),e.replayVal?(console.log("二级回复"),this.msgList[e.index].replyList.unshift({content:e.val,avatarUrl:t.getStorageSync("user_img"),userName:t.getStorageSync("user_name"),createTime:"",praseCount:"",id:e.commentId})):(console.log("一级回复"),this.msgList.unshift({avatarUrl:t.getStorageSync("user_img"),userName:t.getStorageSync("user_name"),content:e.val,createTime:"",praseCount:"",replyList:[],id:e.commentId}))},changeMsgList:function(t){console.log("txtdetail"),void 0==t.index2?this.msgList[t.index].liked?(this.msgList[t.index].liked=!1,this.msgList[t.index].praseCount--):(this.msgList[t.index].liked=!0,this.msgList[t.index].praseCount++):this.msgList[t.index].replyList[t.index2].liked?(this.msgList[t.index].replyList[t.index2].liked=!1,this.msgList[t.index].replyList[t.index2].praseCount--):(this.msgList[t.index].replyList[t.index2].liked=!0,this.msgList[t.index].replyList[t.index2].praseCount++)},confirmShare:function(){this.$refs.popupShare.open()},getLike:function(t){var e=this;this.txtItem.praseStatus?this.api._post("article/likeArticle/".concat(e.txtItem.id),{},(function(t){e.txtItem.praseStatus=!1,e.txtItem.praseCount--})):this.api._post("article/likeArticle/".concat(e.txtItem.id),{},(function(t){e.txtItem.praseStatus=!0,e.txtItem.praseCount++}))}}};e.default=r}).call(this,n("543d")["default"])},"85a0":function(t,e,n){"use strict";var o={sinBarrage:function(){return n.e("components/sin-barrage/sin-barrage").then(n.bind(null,"b4b6"))},uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"66cf"))},uBadge:function(){return n.e("node-modules/uview-ui/components/u-badge/u-badge").then(n.bind(null,"d875"))},uniPopup:function(){return Promise.all([n.e("common/vendor"),n.e("components/uni-popup/uni-popup")]).then(n.bind(null,"f48e"))}},i=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}))},"8cb9":function(t,e,n){},"9b18":function(t,e,n){},a570:function(t,e,n){"use strict";var o=n("9b18"),i=n.n(o);i.a},b682:function(t,e,n){"use strict";(function(t){n("21be");o(n("66fd"));var e=o(n("e7c4"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},bcfa:function(t,e,n){"use strict";n.r(e);var o=n("62dc"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},e7c4:function(t,e,n){"use strict";n.r(e);var o=n("85a0"),i=n("bcfa");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("a570"),n("02b4");var a,c=n("f0c5"),u=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"8ab82b82",null,!1,o["a"],a);e["default"]=u.exports}},[["b682","common/runtime","common/vendor"]]]);