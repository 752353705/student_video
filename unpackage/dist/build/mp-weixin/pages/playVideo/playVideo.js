(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/playVideo/playVideo"],{"372f":function(e,t,o){"use strict";(function(e){o("21be");n(o("66fd"));var t=n(o("8858"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},3787:function(e,t,o){"use strict";o.r(t);var n=o("41e9"),i=o.n(n);for(var s in n)"default"!==s&&function(e){o.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"41e9":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=null,i=function(){Promise.all([o.e("common/vendor"),o.e("components/zhangyu-qrcode-poster/zhangyu-qrcode-poster")]).then(function(){return resolve(o("081d"))}.bind(null,o)).catch(o.oe)},s=function(){o.e("components/user-comment").then(function(){return resolve(o("5541"))}.bind(null,o)).catch(o.oe)},u=function(){o.e("components/uni-popup/uni-popup-share").then(function(){return resolve(o("daf5"))}.bind(null,o)).catch(o.oe)},c=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup-comments")]).then(function(){return resolve(o("0ca6"))}.bind(null,o)).catch(o.oe)},a=function(){o.e("components/uni-popup/uni-popup-gifts").then(function(){return resolve(o("0b1d"))}.bind(null,o)).catch(o.oe)},r=function(){o.e("components/uni-popup/uni-popup-recharge").then(function(){return resolve(o("ad35"))}.bind(null,o)).catch(o.oe)},l=function(){o.e("components/like-button/like-button").then(function(){return resolve(o("8026"))}.bind(null,o)).catch(o.oe)},d={data:function(){return{site:"",coverUrl:"",forwardCount:0,praseCount:0,userId:"",pageDate:new Date,avatarUrl:"",userName:"",conversation:"",videoId:"",videoData:[],videoIndex:0,videoW:"",videoH:"",isPlay:!0,timeStamp:0,clickNum:0,btnShow:!1,like:!1,show_pop:!1,videoContextList:"",focus:!0,commentNum:""}},components:{userComment:s,uniPopupShare:u,uniPopupComments:c,uniPopupGifts:a,uniPopupRecharge:r,likeButton:l,QrcodePoster:i},onLoad:function(t){this.videoId=t.videoId||"842c376a462548f187d8c37df8f2eab7",this.avatarUrl=t.avatarUrl,this.userName=t.userName,this.conversation=t.conversation,this.userId=t.userId,this.id=t.id,this.praseCount=t.praseCount,this.commentNum=parseInt(t.commentNum),this.forwardCount=t.forwardCount,this.coverUrl=t.coverUrl;e.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})},onShow:function(){var e=this;this._post("vod/getPlayInfo",{videoId:e.videoId},(function(t){console.log("获取进行播放的视频 res ===>",t),e.videoData=[{src:t.data.playUrlList[0]}],e.init(),e.like=t.data.praseState,e.focus=!t.data.followState}))},onShareAppMessage:function(e){var t=this;return"button"===e.from&&console.log("按钮进行的转发",e),this._post("vod/forward",{id:t.id},(function(e){console.log("用户进行转发成功",e),t.forwardCount++})),{path:"/pages/playVideo/playVideo?videoId="+this.videoId}},onShareTimeline:function(){return"button"===res.from&&console.log("按钮进行的朋友圈转发",res),{title:"自定义转发标题",query:"videoId=842c376a462548f187d8c37df8f2eab7"}},methods:{recharge:function(e,t){this.$refs.popupRecharge[0].open(),t()},close:function(e){this.$refs.popupShare[e].close()},changeCommentsNum:function(e){this.commentNum+=1},back:function(){e.navigateBack({delta:1})},goAuthor:function(){e.navigateTo({url:"/pages/author/author"})},focusOn:function(){var t=this;this.focus?this._post("follow",{followedId:t.userId},(function(e){t.focus=!1})):e.showModal({content:"确认不在关注",success:function(e){e.confirm?t._post("follow",{followedId:t.userId},(function(e){console.log("进行关注成功",e),t.focus=!0})):e.cancel&&console.log("用户点击取消")}})},init:function(){this.videoContextList=[];for(var t=0;t<this.videoData.length;t++)this.videoContextList.push(e.createVideoContext("myVideo"+t,this));this.videoContextList[0].play(),this.isPlay=!0},handleSlider:function(e){var t=e.detail.current;this.videoIndex>=0&&(this.videoContextList[this.videoIndex].pause(),this.videoContextList[this.videoIndex].seek(0),this.isPlay=!1),t===this.videoIndex+1?(this.videoContextList[this.videoIndex+1].play(),this.isPlay=!0):t===this.videoIndex-1&&(this.videoContextList[this.videoIndex-1].play(),this.isPlay=!0),this.videoIndex=t},play:function(){this.isPlay=!0},pause:function(e){this.videoContextList[e].pause(),this.videoContext.pause(),this.isPlay=!1},handleClicked:function(e){var t=this,o=e.currentTarget.dataset.index,i=this.videoContextList[o];this.clickNum++,this.clickNum>=2&&(console.log("出现红心"),this.site=[e.detail.x,e.detail.y],this.$refs.likeheart[o].handleClick({timeStamp:Date.now()})),n&&clearTimeout(n),n=setTimeout((function(){t.clickNum>=2?(console.log("双击视频 "),t.getLike(0)):(console.log("单机视频"),t.btnShow=!0,t.isPlay?(t.isPlay=!1,i.pause()):(i.play(),t.isPlay=!0,setTimeout((function(){t.btnShow=!1}),1e3))),console.log("清除点击数"),t.clickNum=0}),300)},handleIsLike:function(e){var t=this.vlist;t[e].islike=!t[e].islike,this.vlist=t},sendGift:function(e){console.log("送礼物",e),this.$refs.popupGifts[this.videoIndex].open()},selectgift:function(t,o){e.showModal({title:"提示",content:"您确定赠送".concat(t.item.text,"吗"),success:function(t){t.confirm?e.requestPayment({provider:"wxpay",timeStamp:String(Date.now()),nonceStr:"A1B2C3D4E5",package:"prepay_id=wx20180101abcdefg",signType:"MD5",paySign:"appid=wxd930ea5d5a258f4f&body=test&device_info=1000&mch_id=10000100&nonce_str=ibuaiVcKdpRxkhJA",success:function(e){console.log("success:"+JSON.stringify(e))},fail:function(e){console.log("fail:"+JSON.stringify(e))}}):t.cancel&&console.log("用户点击取消")}})},showPop:function(){this.$refs.popupComments[this.videoIndex].open()},confirmShare:function(){this.$refs.popupShare[this.videoIndex].open()},sharePoster:function(){this.is_show_model=!1,this.$refs.poster[0].showCanvas("https://oss.zhangyubk.com/cmqrcode.jpg")},select:function(e,t){this.sharePoster()},getLike:function(e){var t=this;0==e?t.like||this._post("vod/likeVideo",{videoId:t.id},(function(e){t.like=!0,t.praseCount++})):1==e&&(t.like?this._post("vod/likeVideo",{videoId:t.id},(function(e){t.like=!1,t.praseCount--})):this._post("vod/likeVideo",{videoId:t.id},(function(e){t.like=!0,t.praseCount++})))},change:function(e){var t=this.videoContextList[this.videoIndex];e.show?(this.isPlay=!1,t.pause()):(this.isPlay=!0,t.play())}}};t.default=d}).call(this,o("543d")["default"])},5433:function(e,t,o){"use strict";var n={likeButton:function(){return o.e("components/like-button/like-button").then(o.bind(null,"8026"))},uIcon:function(){return o.e("node-modules/uview-ui/components/u-icon/u-icon").then(o.bind(null,"66cf"))},uniPopup:function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(o.bind(null,"f48e"))}},i=function(){var e=this,t=e.$createElement;e._self._c},s=[];o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return s})),o.d(t,"a",(function(){return n}))},"6e2a":function(e,t,o){"use strict";var n=o("bea6"),i=o.n(n);i.a},8858:function(e,t,o){"use strict";o.r(t);var n=o("5433"),i=o("3787");for(var s in i)"default"!==s&&function(e){o.d(t,e,(function(){return i[e]}))}(s);o("6e2a");var u,c=o("f0c5"),a=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);t["default"]=a.exports},bea6:function(e,t,o){}},[["372f","common/runtime","common/vendor"]]]);